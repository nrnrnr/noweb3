<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>5.5 C Functions</TITLE>
</HEAD>
<BODY LANG="EN">
 <HR>
<B> Next:</B> <A HREF="node19.html">5.6 References to Lua </A>
<B>Up:</B> <A HREF="node13.html">5 The Application Program </A>
<B> Previous:</B> <A HREF="node17.html">5.4 Calling Lua Functions</A>
<HR>
<H2><A NAME="S550">5.5 C Functions</A></H2>
 <A NAME="LuacallC"></A>
To register a C function to Lua,
there is the following macro:
<A NAME="842"></A>
<B><PRE>#define lua_register(n,f)       (lua_pushcfunction(f), lua_storeglobal(n))
/* char *n;         */
/* lua_CFunction f; */</PRE></B>
which receives the name the function will have in Lua,
and a pointer to the function.
This pointer must have type <TT><B>lua_CFunction</B></TT>,
which is defined as
<A NAME="843"></A>
<B><PRE>typedef void (*lua_CFunction) (void);</PRE></B>
that is, a pointer to a function with no parameters and no results.
<P>
In order to communicate properly with Lua,
a C function must follow a protocol,
which defines the way parameters and results are passed.
<P>
To access its arguments, a C function calls:
<A NAME="844"></A>
<B><PRE>lua_Object     lua_getparam             (int number);</PRE></B>
where <TT><B>number</B></TT> starts with 1 to get the first argument.
When called with a number larger than the actual number of arguments,
this function returns
<TT><B>LUA_NOOBJECT</B></TT><A NAME="845"></A>.
In this way, it is possible to write functions that work with
a variable number of parameters.
<P>
To return values, a C function just pushes them onto the stack,
in direct order (see Section&nbsp;<A HREF="node15.html#valuesCLua">5.2</A>).
Like a Lua function, a C function called by Lua can also return
many results.
<P>
Section&nbsp;<A HREF="node38.html#exCFunction">8.9</A> presents an example of a CFunction.
<P>
<HR>
<B> Next:</B> <A HREF="node19.html">5.6 References to Lua </A>
<B>Up:</B> <A HREF="node13.html">5 The Application Program </A>
<B> Previous:</B> <A HREF="node17.html">5.4 Calling Lua Functions</A>
<HR>
</BODY>
